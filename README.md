[![Open in Visual Studio Code](https://classroom.github.com/assets/open-in-vscode-f059dc9a6f8d3a56e377f745f24479a46679e63a5d9fe6f495e02850cd0d8118.svg)](https://classroom.github.com/online_ide?assignment_repo_id=6410124&assignment_repo_type=AssignmentRepo)

# jw05

请将jw04的迷宫任务改造为一个ruguelike的葫芦娃与妖精两方对战游戏，游戏如下图所示。

![](image-11.jpeg)

需求如下：

- 每个生物体都是一个线程
- 每个生物体的移动、攻击等行为决策可使用Minimax或其他算法（可参考https://www.baeldung.com/java-minimax-algorithm）
- 请特别注意线程race condition（两个生物体不能占据同一个tile，对同一生物体的两个攻击行为应该先后发生作用，等）
- 请发挥想象力
- 完成后录屏发qq群或小破站



## 简介

控制一个玩家，通过拾取地图上随机出现的金钱，以购买子弹、炸弹和生命，通过拾取与攻击消灭所有敌人获取胜利。

## 地图

地图上会随机刷新冰块以及石头，玩家和敌人不能穿越这些方块，只能通过子弹或炸弹消除后通过，或者是绕行。

## 元素

金钱：是玩家用来购买其余物品的必须物品，每拾取一个$，即增加玩家自身10块钱；

子弹($10)：通过WASD来控制发射的方向，可以扣除子弹接触到的人1滴血，也可以用来消除冰块，还可以用来提前引爆炸弹；

炸弹($50)：攻击范围为九宫格，可以消除冰块和石头以及金钱，爆炸时可以引爆周围的炸弹，对范围内的所有人扣除5滴血，玩家安置炸弹时会在当前所处位置安放，之后再移动时无法穿越炸弹；

血包($20)：只有血量未满时才可以使用，回复一滴血；

敌人：有5滴血，会向玩家所在地进行移动，在玩家附近时进行攻击，伤害为2滴血；

玩家：有10滴血，初始有一定金钱，通过方向键移动，WASD发射子弹，Space安置炸弹，H购买血包。

各元素不能同占一个Tile（除了子弹在移动时会暂时地经过金钱所处Tile，但因为两者之间没有交互且同占时间较短，所以应该没有竞争情况）

## 并发

画面刷新和统计敌人个数都放在一个单独的线程中执行；

生成金钱的工厂也放在一个线程中执行；

每一个会随时间进行行动的元素都放置在一个单独的线程中执行，因为原本world中的creature列表采用的是ArrayList，在并发编程时可能会产生临界区数据冲突的情况（有些元素在扫描时，另外的元素对列表执行了删除操作等），所以将列表改为CopyOnWriteArrayList，从而不需要加锁，使读操作性能大幅度提升，符合并发的要求。